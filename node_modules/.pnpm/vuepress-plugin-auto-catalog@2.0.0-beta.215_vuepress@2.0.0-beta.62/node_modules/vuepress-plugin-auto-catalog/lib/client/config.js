import{usePageData as x,useSiteData as U,defineClientConfig as k}from"@vuepress/client";import{useLocaleConfig as w,startsWith as v,keys as y,endsWith as m,hasGlobalComponent as G}from"vuepress-shared/client";import{defineComponent as I,computed as R,h as l}from"vue";import{useRouter as D,RouterLink as f}from"vue-router";import"./styles/auto-catalog.scss";import{useAutoCatalogIconComponent as K,injectAutoCatalogIconComponent as M}from"./index.js";var Y=I({name:"AutoCatalog",props:{base:{type:String,default:""},level:{type:Number,default:3},index:Boolean},setup(c){const p=K(),g=w(AUTO_CATALOG_LOCALES),_=x(),T=D(),E=U(),O=i=>{const u=i[AUTO_CATALOG_INDEX_META_KEY];return typeof u>"u"||u},b=()=>{const i=c.base||_.value.path.replace(/\/[^/]+$/,"/"),u=T.getRoutes(),h=[];return u.filter(({meta:t,path:e})=>{if(!v(e,i)||e===i)return!1;if(i==="/"){const a=y(E.value.locales).filter(n=>n!=="/");if(e==="/404.html"||a.some(n=>v(e,n)))return!1}return(m(e,".html")&&!m(e,"/index.html")||m(e,"/"))&&O(t)}).map(({path:t,meta:e})=>{const a=t.substring(i.length).split("/").length;return{title:e[AUTO_CATALOG_TITLE_META_KEY]||"",icon:e[AUTO_CATALOG_ICON_META_KEY],base:t.replace(/\/[^/]+\/?$/,"/"),order:e[AUTO_CATALOG_ORDER_META_KEY]||null,level:m(t,"/")?a-1:a,path:t}}).filter(({title:t,level:e})=>t&&e<=c.level).sort(({title:t,level:e,path:a,order:n},{title:r,level:o,path:d,order:s})=>e-o||(m(a,"/index.html")?-1:m(d,"/index.html")?1:n===null?s===null?t.localeCompare(r):s:s===null?n:n>0?s>0?n-s:-1:s<0?n-s:1)).forEach(t=>{var e;const{base:a,level:n}=t;switch(n){case 1:h.push(t);break;case 2:{const r=h.find(o=>o.path===a);r&&(r.children??=[]).push(t);break}default:{const r=h.find(o=>o.path===a.replace(/\/[^/]+\/$/,"/"));if(r){const o=(e=r.children)==null?void 0:e.find(d=>d.path===a);o&&(o.children??=[]).push(t)}}}}),h},A=R(()=>b());return()=>l("div",{class:"auto-catalog-wrapper"},[l("h2",{class:"main-title"},g.value.title),A.value.length?A.value.map(({children:i=[],icon:u,path:h,title:t},e)=>[l("h3",{id:t,class:["child-title",{"has-children":i.length}]},[l("a",{href:`#${t}`,class:"header-anchor"},"#"),l(f,{class:"catalog-title",to:h},()=>[c.index?`${e+1}.`:null,u&&p?l(p,{icon:u}):null,t||"Unknown"])]),i.length?l("ul",{class:"child-catalog-wrapper"},i.map(({children:a=[],icon:n,path:r,title:o},d)=>l("li",{class:"child-catalog-item"},[l("div",{class:["sub-title",{"has-children":a.length}]},[l("a",{href:`#${o}`,class:"header-anchor"},"#"),l(f,{class:"catalog-title",to:r},()=>[c.index?`${e+1}.${d+1}`:null,n&&p?l(p,{icon:n}):null,o||"Unknown"])]),a.length?l("div",{class:"sub-catalog-wrapper"},a.map(({icon:s,path:C,title:$},L)=>l(f,{class:"sub-catalog-item",to:C},()=>[c.index?`${e+1}.${d+1}.${L+1}`:null,s&&p?l(p,{icon:s}):null,$||"Unknown"]))):null]))):null]):l("p",{class:"empty-catalog"},g.value.empty)])}}),N=k({enhance:({app:c})=>{M(c),G("AutoCatalog",c)||c.component("AutoCatalog",Y)}});export{N as default};
//# sourceMappingURL=config.js.map
