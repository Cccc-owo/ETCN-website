import{useSassPalettePlugin as h}from"vuepress-plugin-sass-palette";import{Logger as K,ensureEndingSlash as C,getTitleFromFilename as E,checkVersion as T,getLocales as y}from"vuepress-shared/node";import{createPage as L}from"@vuepress/core";import{getDirname as M,path as O}from"@vuepress/utils";const v=M(import.meta.url),p="vuepress-plugin-auto-catalog",_=new K(p),R=C(O.resolve(v,"../client")),x=({pages:a},{component:i,iconGetter:r,iconRouteMetaKey:s="icon",shouldIndex:n,indexRouteMetaKey:d="index",orderGetter:u,orderRouteMetaKey:c="order",titleGetter:l=t=>t.title,titleRouteMetaKey:m="title"})=>{i||a.forEach(t=>{const o={},e=l==null?void 0:l(t),g=r==null?void 0:r(t),A=(n==null?void 0:n(t))??null,f=(u==null?void 0:u(t))??null;e&&(o[m]=e),g&&(o[s]=g),typeof A=="boolean"&&(o[d]=A?1:0),typeof f=="number"&&(o[c]=f),t.routeMeta={...t.routeMeta,...o}})},G=async(a,{component:i="AutoCatalog",exclude:r=[],frontmatter:s=()=>({}),level:n=3,index:d=!1})=>{const{env:{isDebug:u},pages:c}=a,l=new Set,m=`<${i}${[1,2].includes(n)?` :level="${n}"`:""}${d?" index":""}/>
`;c.forEach(({path:t,pathLocale:o})=>{let e=t;if(t!=="/404.html")for(;e!==o;)e=e.replace(/\/(?:[^/]+\/?)$/,"/"),!l.has(e)&&r.every(g=>!e.match(g))&&c.every(({path:g})=>g!==e)&&(u&&_.info(`Generating catalog ${e}}`),l.add(e))}),await Promise.all(Array.from(l).map(t=>decodeURI(t)).map(t=>{const[,o=""]=/\/([^/]+)\/?$/.exec(t)||[],e=E(o);return L(a,{frontmatter:{title:e,...s(t)||{}},content:m,path:t})})).then(t=>{a.pages.push(...t)})},I={"/en/":{title:"Catalog"},"/zh/":{title:"目录"},"/zh-tw/":{title:"目錄"},"/de/":{title:"Katalog"},"/de-at/":{title:"Katalog"},"/vi/":{title:"Danh mục"},"/uk/":{title:"Каталог"},"/ru/":{title:"Каталог"},"/br/":{title:"Catálogo"},"/pl/":{title:"Katalog"},"/sk/":{title:"Katalóg"},"/fr/":{title:"Catalogue"},"/es/":{title:"Catálogo"},"/ja/":{title:"カタログ"},"/tr/":{title:"Katalog"},"/ko/":{title:"목차"},"/fi/":{title:"Luettelo"},"/hu/":{title:"Katalógus"},"/id/":{title:"Katalog"},"/nl/":{title:"Catalogus"}},$=(a={})=>i=>{T(i,p,"2.0.0-beta.62"),i.env.isDebug&&_.info("Options:",a),h(i,{id:"hope"});const{component:r,iconRouteMetaKey:s="icon",indexRouteMetaKey:n="index",locales:d,orderRouteMetaKey:u="order",titleRouteMetaKey:c="title"}=a;return{name:p,define:()=>({AUTO_CATALOG_LOCALES:y({app:i,name:p,default:I,config:d}),AUTO_CATALOG_TITLE_META_KEY:c,AUTO_CATALOG_ICON_META_KEY:s,AUTO_CATALOG_ORDER_META_KEY:u,AUTO_CATALOG_INDEX_META_KEY:n}),onInitialized:async l=>{x(l,a),await G(l,a)},...r?{}:{clientConfigFile:`${R}config.js`}}};export{$ as autoCatalogPlugin};
//# sourceMappingURL=index.js.map
