{"version":3,"file":"BingHeroBackground.js","sourceRoot":"","sources":["../../src/presets/BingHeroBackground.ts"],"names":[],"mappings":"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","sourcesContent":["import { ClientOnly, usePageLang } from \"@vuepress/client\";\nimport { useStorage } from \"@vueuse/core\";\nimport { type VNode, computed, defineComponent, h, onMounted } from \"vue\";\n\nimport \"./bing-hero-background.scss\";\n\ninterface BingWallpaperInfo {\n  url: string;\n  wallpaper: string;\n  downloadable: boolean;\n  locales: Record<\n    string,\n    {\n      title: string;\n      description: string;\n      headline: string;\n      copyright: string;\n      backstage: string;\n      quickFact: string;\n    }\n  >;\n}\nconst bingStorage = useStorage<{\n  index: number;\n  data: BingWallpaperInfo[];\n}>(\"bing-image\", {\n  index: 0,\n  data: [],\n});\n\nexport default defineComponent({\n  name: \"BingHeroBackground\",\n\n  // TODO: Add download button, image description and copyright information\n  // props: {\n  //   download: Boolean,\n  // },\n\n  setup() {\n    const lang = usePageLang();\n\n    const currentWallpaper = computed(() => {\n      const info = bingStorage.value.data[bingStorage.value.index];\n      const langCode = lang.value.toLowerCase().split(\"-\").shift();\n\n      if (info) {\n        const { url, wallpaper, downloadable, locales } = info;\n\n        return {\n          url,\n          wallpaper,\n          downloadable,\n          ...(locales[langCode!] ?? locales[\"en\"]),\n        };\n      }\n\n      return null;\n    });\n\n    const getImage = (): Promise<BingWallpaperInfo[]> => {\n      return fetch(\"https://bing-wallpaper.vuejs.press/api/wallpaper\").then(\n        (response) => <Promise<BingWallpaperInfo[]>>response.json()\n      );\n    };\n\n    const prev = (): void => {\n      bingStorage.value.index--;\n    };\n\n    const next = (): void => {\n      bingStorage.value.index++;\n    };\n\n    onMounted(() => {\n      void getImage().then((res) => {\n        bingStorage.value.data = res;\n      });\n    });\n\n    return (): VNode =>\n      h(ClientOnly, () =>\n        currentWallpaper.value\n          ? [\n              h(\"div\", {\n                class: \"mask\",\n                style: {\n                  background: `url(${currentWallpaper.value.url}) center/cover no-repeat`,\n                },\n              }),\n              h(\"div\", { class: \"bing-switch\" }, [\n                h(\n                  \"a\",\n                  {\n                    class: \"bing-info\",\n                    href: currentWallpaper.value.backstage,\n                    target: \"_blank\",\n                  },\n                  [\n                    h(\"span\", { class: \"bing-location-icon\" }),\n                    currentWallpaper.value.title,\n                  ]\n                ),\n                h(\"button\", {\n                  class: \"bing-switch-left\",\n                  disabled: bingStorage.value.index === 0,\n                  onClick: () => prev(),\n                }),\n                h(\"button\", {\n                  class: \"bing-switch-right\",\n                  disabled:\n                    bingStorage.value.index ===\n                    bingStorage.value.data.length - 1,\n                  onClick: () => next(),\n                }),\n              ]),\n            ]\n          : null\n      );\n  },\n});\n"]}