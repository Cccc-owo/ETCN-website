import{useSassPalettePlugin as C}from"vuepress-plugin-sass-palette";import{Logger as _,ensureEndingSlash as E,getTitleFromFilename as K,checkVersion as T,getLocales as y}from"vuepress-shared/node";import{createPage as L}from"@vuepress/core";import{getDirname as v,path as M,colors as g}from"@vuepress/utils";const G=v(import.meta.url),f="vuepress-plugin-auto-catalog",O=new _(f),I=E(M.resolve(G,"../client")),w=({pages:e},{component:n,iconGetter:o,iconRouteMetaKey:i="icon",shouldIndex:c,indexRouteMetaKey:s="index",orderGetter:l,orderRouteMetaKey:r="order",titleGetter:p=t=>t.title,titleRouteMetaKey:u="title"})=>{n||e.forEach(t=>{const d={},a=p==null?void 0:p(t),m=o==null?void 0:o(t),h=(c==null?void 0:c(t))??null,$=(l==null?void 0:l(t))??null;a&&(d[u]=a),m&&(d[i]=m),typeof h=="boolean"&&(d[s]=h?1:0),typeof $=="number"&&(d[r]=$),t.routeMeta={...t.routeMeta,...d}})},x=async(e,{component:n="AutoCatalog",exclude:o=[],frontmatter:i=()=>({}),level:c=3,index:s=!1})=>{const{env:{isDebug:l},pages:r}=e,p=new Set,u=`<${n}${[1,2].includes(c)?` :level="${c}"`:""}${s?" index":""}/>
`;r.forEach(({path:t,pathLocale:d})=>{let a=t;if(t!=="/404.html")for(;a!==d;)a=a.replace(/\/(?:[^/]+\/?)$/,"/"),!p.has(a)&&o.every(m=>!a.match(m))&&r.every(({path:m})=>m!==a)&&(l&&O.info(`Generating catalog ${a}}`),p.add(a))}),await Promise.all(Array.from(p).map(t=>decodeURI(t)).map(t=>{const[,d=""]=/\/([^/]+)\/?$/.exec(t)||[],a=K(d);return L(e,{frontmatter:{title:a,...i(t)||{}},content:u,path:t})})).then(t=>{e.pages.push(...t)})},A=({options:e,deprecatedOption:n,newOption:o,msg:i="",scope:c=""})=>{if(n in e){if(O.warn(`${g.magenta(n)} is ${g.yellow("deprecated")}${c?` in ${c}`:""}, please use "${g.magenta(o)}" instead.${i?`
${i}`:""}`),o.includes(".")){const s=o.split(".");let l=e;s.forEach((r,p)=>{p!==s.length-1?(l[r]=l[r]||{},l=l[r]):l[r]=e[n]})}else e[o]=e[n];delete e[n]}},R=(e,n,o="",i="")=>{n in e&&(O.error(`"${g.magenta(n)}" is ${g.red("removed")}${i?`, please use ${g.magenta(i)} instead.`:" and no longer supported"}${o?`
${o}`:""}`),i||delete e[n])},D=e=>{A({options:e,deprecatedOption:"getTitle",newOption:"titleGetter"}),A({options:e,deprecatedOption:"getIcon",newOption:"iconGetter"}),A({options:e,deprecatedOption:"getOrder",newOption:"orderGetter"}),A({options:e,deprecatedOption:"getIndex",newOption:"shouldIndex"}),R(e,"iconComponent",`please use ${g.magenta("defineAutoCatalogIconComponent")} in client config file.`)},U={"/en/":{title:"Catalog"},"/zh/":{title:"目录"},"/zh-tw/":{title:"目錄"},"/de/":{title:"Katalog"},"/de-at/":{title:"Katalog"},"/vi/":{title:"Danh mục"},"/uk/":{title:"Каталог"},"/ru/":{title:"Каталог"},"/br/":{title:"Catálogo"},"/pl/":{title:"Katalog"},"/sk/":{title:"Katalóg"},"/fr/":{title:"Catalogue"},"/es/":{title:"Catálogo"},"/ja/":{title:"カタログ"},"/tr/":{title:"Katalog"},"/ko/":{title:"목차"},"/fi/":{title:"Luettelo"},"/hu/":{title:"Katalógus"},"/id/":{title:"Katalog"},"/nl/":{title:"Catalogus"}},b=(e={},n=!0)=>o=>{n&&D(e),T(o,f,"2.0.0-beta.62"),o.env.isDebug&&O.info("Options:",e),C(o,{id:"hope"});const{component:i,iconRouteMetaKey:c="icon",indexRouteMetaKey:s="index",locales:l,orderRouteMetaKey:r="order",titleRouteMetaKey:p="title"}=e;return{name:f,define:()=>({AUTO_CATALOG_LOCALES:y({app:o,name:f,default:U,config:l}),AUTO_CATALOG_TITLE_META_KEY:p,AUTO_CATALOG_ICON_META_KEY:c,AUTO_CATALOG_ORDER_META_KEY:r,AUTO_CATALOG_INDEX_META_KEY:s}),onInitialized:async u=>{w(u,e),await x(u,e)},...i?{}:{clientConfigFile:`${I}config.js`}}};export{b as autoCatalogPlugin};
//# sourceMappingURL=index.js.map
